

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>flame_utils.io.output &mdash; flame-utils  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/frib-favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> flame-utils
          

          
          </a>

          
            
            
              <div class="version">
                0.3.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../element.html">Lattice Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../beamstate.html">BeamState Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modelflame.html">ModelFlame Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plotlat.html">Plot function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">Application Programming Interface</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">flame-utils</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>flame_utils.io.output</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for flame_utils.io.output</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;Output from FLAME.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">flame_utils.core</span> <span class="kn">import</span> <span class="n">BeamState</span>


<div class="viewcode-block" id="convert_results"><a class="viewcode-back" href="../../../flame_utils.io.html#flame_utils.convert_results">[docs]</a><span class="k">def</span> <span class="nf">convert_results</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert all beam states of results generated by :func:`run()` method</span>
<span class="sd">    to be ``BeamState`` object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    res : list of tuple</span>
<span class="sd">        List of propagation results.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list of tuple</span>
<span class="sd">        Tuple of ``(r, s)``, where ``r`` is list of results at each monitor</span>
<span class="sd">        points, ``s`` is ``BeamState`` object after the last monitor point.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">BeamState</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span></div>


<div class="viewcode-block" id="collect_data"><a class="viewcode-back" href="../../../flame_utils.io.html#flame_utils.collect_data">[docs]</a><span class="k">def</span> <span class="nf">collect_data</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Collect data of interest from propagation results.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    result :</span>
<span class="sd">        Propagation results with ``BeamState`` object.</span>
<span class="sd">    args :</span>
<span class="sd">        Names of attribute, separated by comma.</span>

<span class="sd">    Keyword Arguments</span>
<span class="sd">    -----------------</span>
<span class="sd">    pos : float</span>
<span class="sd">        Longitudinally propagating position, [m].</span>
<span class="sd">    ref_beta : float</span>
<span class="sd">        Speed in the unit of light velocity in vacuum of reference charge</span>
<span class="sd">        state, Lorentz beta.</span>
<span class="sd">    ref_bg : float</span>
<span class="sd">        Multiplication of beta and gamma of reference charge state.</span>
<span class="sd">    ref_gamma : float</span>
<span class="sd">        Relativistic energy of reference charge state, Lorentz gamma.</span>
<span class="sd">    ref_IonEk : float</span>
<span class="sd">        Kinetic energy of reference charge state, [eV/u].</span>
<span class="sd">    ref_IonEs : float</span>
<span class="sd">        Rest energy of reference charge state, [eV/u].</span>
<span class="sd">    ref_IonQ : int</span>
<span class="sd">        Macro particle number of reference charge state.</span>
<span class="sd">    ref_IonW : float</span>
<span class="sd">        Total energy of reference charge state, [eV/u],</span>
<span class="sd">        i.e. :math:`W = E_s + E_k`.</span>
<span class="sd">    ref_IonZ : float</span>
<span class="sd">        Reference charge state, measured by charge to mass ratio, e.g.</span>
<span class="sd">        :math:`^{33^{+}}_{238}U: Q[33]/A[238]`.</span>
<span class="sd">    ref_phis : float</span>
<span class="sd">        Absolute synchrotron phase of reference charge state, [rad].</span>
<span class="sd">    ref_SampleIonK : float</span>
<span class="sd">        Wave-vector in cavities with different beta values of reference charge</span>
<span class="sd">        state.</span>
<span class="sd">    beta : Array</span>
<span class="sd">        Speed in the unit of light velocity in vacuum of all charge states,</span>
<span class="sd">        Lorentz beta.</span>
<span class="sd">    bg : Array</span>
<span class="sd">        Multiplication of beta and gamma of all charge states.</span>
<span class="sd">    gamma : Array</span>
<span class="sd">        Relativistic energy of all charge states, Lorentz gamma.</span>
<span class="sd">    IonEk : Array</span>
<span class="sd">        Kinetic energy of all charge states, [eV/u].</span>
<span class="sd">    IonEs : Array</span>
<span class="sd">        Rest energy of all charge states, [eV/u].</span>
<span class="sd">    IonQ : Array</span>
<span class="sd">        Macro particle number of all charge states.</span>
<span class="sd">    IonW : Array</span>
<span class="sd">        Total energy of all charge states, [eV/u], i.e. :math:`W = E_s + E_k`.</span>
<span class="sd">    IonZ : Array</span>
<span class="sd">        All charge states, measured by charge to mass ratio</span>
<span class="sd">    phis : Array</span>
<span class="sd">        Absolute synchrotron phase of all charge states, [rad]</span>
<span class="sd">    SampleIonK : Array</span>
<span class="sd">        Wave-vector in cavities with different beta values of all charge</span>
<span class="sd">        states.</span>
<span class="sd">    x0_env, xcen : float</span>
<span class="sd">        Weight average of all charge states for x&#39;, [rad].</span>
<span class="sd">    y0_env, ycen : float</span>
<span class="sd">        Weight average of all charge states for y, [mm].</span>
<span class="sd">    xp0_env, xpcen : float</span>
<span class="sd">        Weight average of all charge states for x&#39;, [rad].</span>
<span class="sd">    yp0_env, ypcen : float</span>
<span class="sd">        Weight average of all charge states for y&#39;, [rad].</span>
<span class="sd">    phi0_env, phicen, zcen: float</span>
<span class="sd">        Weight average of all charge states for :math:`\phi`, [rad].</span>
<span class="sd">    dEk0_env, dEkcen, zpcen : float</span>
<span class="sd">        Weight average of all charge states for :math:`\delta E_k`, [MeV/u].</span>
<span class="sd">    x0, xcen_all : Array</span>
<span class="sd">        X centroid for all charge states, [mm].</span>
<span class="sd">    y0, ycen_all : Array</span>
<span class="sd">        Y centroid for all charge states, [mm].</span>
<span class="sd">    xp0, xpcen_all : Array</span>
<span class="sd">        X centroid divergence for all charge states, [rad].</span>
<span class="sd">    yp0, ypcen_all : Array</span>
<span class="sd">        Y centroid divergence for all charge states, [rad].</span>
<span class="sd">    phi0, phicen_all, zcen_all : Array</span>
<span class="sd">        Longitudinal beam length, measured in RF frequency for all charge</span>
<span class="sd">        states, [rad].</span>
<span class="sd">    dEk0, dEkcen_all, zpcen_all : Array</span>
<span class="sd">        Kinetic energy deviation w.r.t. reference charge state, for all charge</span>
<span class="sd">        states, [MeV/u].</span>
<span class="sd">    x0_rms, xrms : float</span>
<span class="sd">        General rms beam envelope for x, [mm].</span>
<span class="sd">    y0_rms, yrms : float</span>
<span class="sd">        General rms beam envelope for y, [mm].</span>
<span class="sd">    xp0_rms, xprms : float</span>
<span class="sd">        General rms beam envelope for x&#39;, [rad].</span>
<span class="sd">    yp0_rms, yprms : float</span>
<span class="sd">        General rms beam envelope for y&#39;, [rad].</span>
<span class="sd">    phi0_rms, phirms, zrms : float</span>
<span class="sd">        General rms beam envelope for :math:`\phi`, [rad].</span>
<span class="sd">    dEk0_rms, dEkrms, zprms : float</span>
<span class="sd">        General rms beam envelope for :math:`\delta E_k`, [MeV/u].</span>
<span class="sd">    xrms_all : Array</span>
<span class="sd">        General rms beam envelope for x of all charge states, [mm].</span>
<span class="sd">    yrms_all : Array</span>
<span class="sd">        General rms beam envelope for y of all charge states, [mm].</span>
<span class="sd">    xprms_all : Array</span>
<span class="sd">        General rms beam envelope for x&#39; of all charge states, [rad].</span>
<span class="sd">    yprms_all : Array</span>
<span class="sd">        General rms beam envelope for y&#39; of all charge states, [rad].</span>
<span class="sd">    phirms_all : Array</span>
<span class="sd">        General rms beam envelope for :math:`\phi` of all charge states, [rad].</span>
<span class="sd">    dEkrms_all : Array</span>
<span class="sd">        General rms beam envelope for :math:`\delta E_k` of all charge states, [MeV/u].</span>
<span class="sd">    moment0_env, cenvector : Array</span>
<span class="sd">        Weight average of centroid for all charge states, array of</span>
<span class="sd">        ``[x, x&#39;, y, y&#39;, phi, dEk, 1]``, with the units of</span>
<span class="sd">        ``[mm, rad, mm, rad, rad, MeV/u, 1]``.</span>
<span class="sd">    moment0, cenvector_all : Array</span>
<span class="sd">        Centroid for all charge states, array of ``[x, x&#39;, y, y&#39;, phi, dEk, 1]``.</span>
<span class="sd">    moment0_rms, rmsvector : Array</span>
<span class="sd">        RMS beam envelope, part of statistical results from ``moment1``.</span>
<span class="sd">    moment1, beammatrix_all : Array</span>
<span class="sd">        Correlation tensor of all charge states, for each charge state.</span>
<span class="sd">    moment1_env, beammatrix : Array</span>
<span class="sd">        Correlation tensor of all charge states, average over all charge states.</span>
<span class="sd">    xemittance, xeps : float</span>
<span class="sd">        Weight average of geometrical x emittance, [mm-mrad].</span>
<span class="sd">    yemittance, yeps : float</span>
<span class="sd">        Weight average of geometrical y emittance, [mm-mrad].</span>
<span class="sd">    zemittance, zeps : float</span>
<span class="sd">        Weight average of geometrical z emittance, [rad-MeV/u].</span>
<span class="sd">    xnemittance, xepsn : float</span>
<span class="sd">        Weight average of normalized x emittance, [mm-mrad].</span>
<span class="sd">    ynemittance, yepsn : float</span>
<span class="sd">        Weight average of normalized y emittance, [mm-mrad].</span>
<span class="sd">    znemittance, zepsn : float</span>
<span class="sd">        Weight average of normalized z emittance, [rad-MeV/u].</span>
<span class="sd">    xemittance_all, xeps_all : Array</span>
<span class="sd">        Geometrical x emittance of all charge states, [mm-mrad].</span>
<span class="sd">    yemittance_all, yeps_all : Array</span>
<span class="sd">        Geometrical y emittance of all charge states, [mm-mrad].</span>
<span class="sd">    zemittance_all, zeps_all : Array</span>
<span class="sd">        Geometrical z emittance of all charge states, [rad-MeV/u].</span>
<span class="sd">    xnemittance_all, xepsn_all : Array</span>
<span class="sd">        Normalized x emittance of all charge states, [mm-mrad].</span>
<span class="sd">    ynemittance_all, yepsn_all : Array</span>
<span class="sd">        Normalized y emittance of all charge states, [mm-mrad].</span>
<span class="sd">    znemittance_all, zepsn_all : Array</span>
<span class="sd">        Normalized z emittance of all charge states, [rad-MeV/u].</span>
<span class="sd">    xtwiss_beta, xtwsb : float</span>
<span class="sd">        Weight average of twiss beta x, [m/rad].</span>
<span class="sd">    ytwiss_beta, ytwsb : float</span>
<span class="sd">        Weight average of twiss beta y, [m/rad].</span>
<span class="sd">    ztwiss_beta, ztwsb : float</span>
<span class="sd">        Weight average of twiss beta z, [rad/MeV/u].</span>
<span class="sd">    xtwiss_alpha, xtwsa : float</span>
<span class="sd">        Weight average of twiss alpha x, [1].</span>
<span class="sd">    ytwiss_alpha, ytwsa : float</span>
<span class="sd">        Weight average of twiss alpha y, [1].</span>
<span class="sd">    ztwiss_alpha, ztwsa : float</span>
<span class="sd">        Weight average of twiss alpha z, [1].</span>
<span class="sd">    xtwiss_beta_all, xtwsb_all : Array</span>
<span class="sd">        Twiss beta x of all charge states, [m/rad].</span>
<span class="sd">    ytwiss_beta_all, ytwsb_all : Array</span>
<span class="sd">        Twiss beta y of all charge states, [m/rad].</span>
<span class="sd">    ztwiss_beta_all, ztwsb_all : Array</span>
<span class="sd">        Twiss beta z of all charge states, [rad/MeV/u].</span>
<span class="sd">    xtwiss_alpha_all, xtwsa_all : Array</span>
<span class="sd">        Twiss alpha x of all charge states, [1].</span>
<span class="sd">    ytwiss_alpha_all, ytwsa_all : Array</span>
<span class="sd">        Twiss alpha y of all charge states, [1].</span>
<span class="sd">    ztwiss_alpha_all, ztwsa_all : Array</span>
<span class="sd">        Twiss alpha z of all charge states, [1].</span>
<span class="sd">    couple_xy, cxy : float</span>
<span class="sd">        Weigth average of normalized x-y coupling term, [1].</span>
<span class="sd">    couple_xpy, cxpy : float</span>
<span class="sd">        Weigth average of normalized xp-y coupling term, [1].</span>
<span class="sd">    couple_xyp, cxyp : float</span>
<span class="sd">        Weigth average of normalized x-yp coupling term, [1].</span>
<span class="sd">    couple_xpyp, cxpyp : float</span>
<span class="sd">        Weigth average of normalized xp-yp coupling term, [1].</span>
<span class="sd">    couple_xy_all, cxy_all : Array</span>
<span class="sd">        Normalized x-y coupling term of all charge states, [1].</span>
<span class="sd">    couple_xpy_all, cxpy_all : Array</span>
<span class="sd">        Normalized xp-y coupling term of all charge states, [1].</span>
<span class="sd">    couple_xyp_all, cxyp_all : Array</span>
<span class="sd">        Normalized x-yp coupling term of all charge states, [1].</span>
<span class="sd">    couple_xpyp_all, cxpyp_all : Array</span>
<span class="sd">        Normalized xp-yp coupling term of all charge states, [1].</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        Dict of ``{k1:v1, k2,v2...}``, keys are from keyword parameters.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    1. Set the data of interest with ``k=True`` as input will return the defined</span>
<span class="sd">       ``k`` value.</span>
<span class="sd">    2. Invalid attribute names will be ignored.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; # get x0 and y0 array</span>
<span class="sd">    &gt;&gt;&gt; collect_data(r, x0=True, y0=True)</span>
<span class="sd">    &gt;&gt;&gt; # which is equivalent as:</span>
<span class="sd">    &gt;&gt;&gt; collect_data(r, &#39;x0&#39;, &#39;y0&#39;)</span>
<span class="sd">    &gt;&gt;&gt; # or:</span>
<span class="sd">    &gt;&gt;&gt; collect_data(r, &#39;x0&#39;, y0=True)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    BeamState : FLAME beam state class for ``MomentMatrix`` simulation type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">kws</span><span class="p">)</span>
                  <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">BeamState</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="n">k</span><span class="p">)]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">ik</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">getattr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ik</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="n">result</span><span class="p">])</span> <span class="k">for</span> <span class="n">ik</span> <span class="ow">in</span> <span class="n">valid_keys</span><span class="p">}</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">convert_results</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">ik</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">getattr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ik</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="n">result</span><span class="p">])</span> <span class="k">for</span> <span class="n">ik</span> <span class="ow">in</span> <span class="n">valid_keys</span><span class="p">}</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018-2020, Facility for Rare Isotope Beams, Michigan State University
      <span class="lastupdated">
        Last updated on Jul 30, 2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>